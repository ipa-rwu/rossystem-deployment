<?xml version="1.0"?>
<launch>
  <arg name="config" default="base" />
  <arg name="env_runner" value="$(eval 'env_run' if not optenv('OS', 'unknown').lower().startswith('windows') else 'env_run.bat')" />

  <param name="robot_description"
         command="$(find jackal_description)/scripts/$(arg env_runner)
                    $(find jackal_description)/urdf/configs/$(arg config)
                    $(find xacro)/xacro $(find jackal_description)/urdf/jackal.urdf.xacro
                    --inorder" />

  <node pkg="jackal_base" type="jackal_node" name="jackal_node" cwd="node" respawn="false" output="screen">
    <param name="require/publishers" value="[status,feedback,imu/data_raw,navsat/nmea_sentence]" />
    <param name="require/subscribers" value="[cmd_drive,wifi_connected]" />
    <param name="wireless_interface" value="wlp2s0" />
    <param name="port" value="/dev/jackal" />
  </node>

  <node pkg="nmea_navsat_driver" type="nmea_topic_driver" name="nmea_topic_driver" ns="navsat" cwd="node" respawn="false" output="screen">
  </node>

  <node pkg="rosserial_python" type="message_info_service" name="rosserial_message_info" cwd="node" respawn="false" output="screen">
  </node>

  <rosparam command="load" file="$(find jackal_control)/config/control.yaml" />
  <node pkg="controller_manager" type="spawner" name="controller_spawner" cwd="node" respawn="false" output="screen"
    args="jackal_joint_publisher jackal_velocity_controller" >
  </node>

</launch>
